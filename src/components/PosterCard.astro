---
import LabelChip from "./LabelChip.astro";

interface Props {
    product: any;
    class?: string;
}

const { product, class: className } = Astro.props;
const base = import.meta.env.BASE_URL;

const statusColors = {
    available: "default",
    "sold-out": "outline",
    "coming-soon": "acid",
} as const;
---

<div
    class:list={[
        "group relative flex flex-col border border-line-light",
        className,
    ]}
>
    <a
        href={`${base}product/${product.slug}`}
        class="block overflow-hidden relative aspect-[3/4]"
    >
        <img
            src={`${base}${product.images[0]}`}
            alt={product.title}
            class="w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-105"
            loading="lazy"
        />

        <div class="absolute top-4 left-4 flex flex-col gap-2">
            <LabelChip
                text={product.status.replace("-", " ")}
                type={statusColors[product.status] as any}
            />
        </div>

        {
            product.status === "sold-out" && (
                <div class="absolute inset-0 bg-void/40 flex items-center justify-center backdrop-blur-[2px]">
                    <span class="font-space text-bone text-4xl font-black -rotate-12 tracking-tighter opacity-80">
                        SOLD OUT
                    </span>
                </div>
            )
        }

        <!-- Hover Label Reveal -->
        <div
            class="absolute bottom-0 left-0 w-full p-4 transform translate-y-full group-hover:translate-y-0 transition-transform duration-300 bg-ink/90 backdrop-blur-sm text-bone"
        >
            <p class="text-[10px] uppercase tracking-widest font-bold">
                Quick View // Details
            </p>
        </div>
    </a>

    <div class="p-4 flex flex-col gap-1 border-t border-line-light bg-bone">
        <div class="flex justify-between items-start">
            <h3
                class="font-space font-bold text-lg tracking-tight leading-none group-hover:text-acid transition-colors"
            >
                <a href={`${base}product/${product.slug}`}>{product.title}</a>
            </h3>
            <span class="font-space text-lg font-light tracking-tighter"
                >${product.price}</span
            >
        </div>
        <div class="flex justify-between items-center mt-2">
            <span class="text-[10px] text-muted uppercase tracking-widest"
                >{product.category}</span
            >
            <span class="text-[10px] text-muted uppercase tracking-widest"
                >{product.drop}</span
            >
        </div>
    </div>

    <!-- Decorative corner tick -->
    <div
        class="absolute -top-px -right-px w-3 h-3 border-t border-r border-acid opacity-0 group-hover:opacity-100 transition-opacity"
    >
    </div>
    <div
        class="absolute -bottom-px -left-px w-3 h-3 border-b border-l border-acid opacity-0 group-hover:opacity-100 transition-opacity"
    >
    </div>
</div>
